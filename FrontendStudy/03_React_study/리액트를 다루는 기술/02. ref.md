# 리액트를 다루는 기술

DOM요소에 접근하여 이를 활용하기위한 ref를 알아보자.

## 5. ref: DOM에 이름달기

- HTML에서 id를 사용하여 DOM에 이름을 다는 것처럼 리액트 프로젝트 내부에서 DOM에 이름을 다는 방법이 바로 ref(reference)의 개념.

:bulb: HTML처럼 그냥 id를 쓰면되지 않나?

id사용이 가능하긴 하지만 권장하지 않는다. 컴포넌트에서 사용할 경우 id가또한 재사용되게 되는데 HTML에서 DOM의 id는 유일(unique)해야하기 때문에 이러한 사용은 잘못된 사용이다.(혹시나 다른 라이브러리나 프레임워크와 함께 id를 사용해야 하는 상황이 있을경우 컴포넌트를 만들 때마다 id 뒷부분에 추가 텍스트를 붙여서 중복 id가 발생하는 것을 방지해야 한다.)

ref는 전역적으로 작동하지 않고 컴포넌트 내부에서만 작동하기 때문에 이런 문제가 생기지 않는다.

- ref는 어떤 상황에 사용할까

  특정 DOM에 작업을 해야 할 때 사용한다. 그럼 '작업'을 할 때 ref를 사용해야 하는가.

  DOM을 꼭 직접적으로 건드려야 할 때

- DOM을 꼭 사용해야 하는 상황

  state를 사용하여 기능을 구현할수도 있지만, 가끔 state만으로도 해결할 수 없는 기능이 있다.

  - 특정 input 포커스 주기
  - 스크롤 박스 조작
  - Canvas 요소에 그림 그리기 등

### ref 사용

- 콜백 함수를 통한 ref 설정

  ref를 만드는 가장 기본적인 방법. ref를 달고자 하는 요소에 ref라는 콜백 함수를 props로 전달해주면 된다. 이 함수는 ref 값을 파라미터로 전달받고, 함수 내부에서 파라미터로 받은 ref를 컴포넌트의 멤버 변수로 설정해준다.

  ```react
  <input ref={(ref) => {this.input=ref}} />
  ```

  이렇게 하면 앞으로 this.input은 input 요소의 DOM을 가리키게된다.

- createRef를 통한 ref 설정

  ref를 만드는 또 다른 방법은 리액트에 내장되어 있는 createRef함수를 사용하는 것

  ```react
  {...}
  input = React.createRef();
  
  handleFocus = () => {
      this.input.current.focus();
  }
  
  render() {
  	return (
      	<input ref={this.input} />
      )
  }
  ```

- 컴포넌트에 ref 달기

  컴포넌트 내부에 있는 DOM을 컴포넌트 외부에서 사용할 때 주로 사용한다.

  ```react
  <MyComponent ref={ref => this.myComponent = ref} />
  ```

  이렇게 하면 MyComponent 내부의 메서드 및 멤버변수에도 접근이 가능하다.

  ex. myComponent.handleClick, myComponent.input 등

- 스크롤바 내리기 예시

  자바스크립트로 스크롤바를 내릴 때는 DOM 노드가 가진 아래 값을 사용한다.

  - scrollTop : 세로 스크롤바 위치
  - scrollHeight : 스크롤이 있는 박스 안의 div 높이
  - clientHeight : 스크롤이 있는 박스의 높이

## 정리

컴포넌트 내부에서 DOM에 직접 접근해야 할 때는 ref를 사용한다. ref 사용 전 ref를 사용하지 않고 원하는 기능을 구현할 수 있는지 고려한 후에 활용하는 것이 좋다.

예를 들어 서로 다른 컴포넌트끼리 데이터를 교류할 때 ref를 사용하는 것은 잘못된 방식이다. 컴포넌트끼리 데이터를 교류할 때는 언제나 데이터를 부모 <-> 자식 흐름으로 교류한다.



